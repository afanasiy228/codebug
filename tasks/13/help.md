Используй алгоритм Кадане: dp[i] = max(a[i], dp[i-1] + a[i]).
