Можно использовать сортировку слиянием или BIT.
