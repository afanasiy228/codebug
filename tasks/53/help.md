Бинпоиск по ответу и проверка жадным разбиением.
