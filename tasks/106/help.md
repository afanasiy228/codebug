1) Отсортируйте массив.
2) Для каждого запроса используйте upper_bound.
3) Ответы получаются за O(log n) каждый.
