Подходит КМП или Z-функция.
