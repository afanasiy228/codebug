1) Посчитайте хеши строки и обратной строки.
2) Подстрока палиндромна, если хеш равен хешу обратной подстроки.
3) На каждый запрос отвечайте за O(1).
