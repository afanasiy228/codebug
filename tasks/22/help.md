Можно использовать бинпоиск по ответу.
