1) Постройте суффиксный автомат строки.
2) Каждый переход автомата соответствует появлению новых подстрок.
3) Количество различных подстрок равно сумме `len[v] - len[link[v]]` по всем состояниям.
