DP по весу с проходом по весам в обратном порядке.
